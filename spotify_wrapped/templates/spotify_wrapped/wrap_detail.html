{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ wrap_name }}</title>

    <!-- Default theme is dark mode -->
    <link rel="stylesheet" href="{% static 'css/wrap_detail.css' %}" id="theme-stylesheet">  <!-- Dark theme uses wrap_detail.css -->

</head>
<body>
    <div class="wrap-container">
        <!-- button to go back to dashboard -->
        <a href="http://localhost:8000/accounts/dashboard/" class="back-btn">
            <button type="button">Back to Dashboard</button>
        </a>
        <!-- Theme toggle button -->
        <!-- <button id="toggle-theme" class="theme-toggle-btn">Toggle Light Mode</button> -->

        <h1 class="wrap-title">{{ wrap_name }}</h1>

        <div id="slides" class="slides-container">
            <!-- Slide 1: Intro -->
            <div class="slide active">
                <h2 class="section-title">Hey {{user.username}}</h2>
                <ul class="track-list">
                    <h2>Its Wrapped Time</h2>
                    <h2>Ready? Lets do this!</h2>
                </ul>
            </div>
            <!-- Slide 2: Top Tracks -->
            <div class="slide active">
                <h2 class="section-title">Top Tracks</h2>
                <ul class="track-list">
                    {% for track in top_tracks %}
                        <li class="track-item">
                            <div class="track-name">{{ track.track_name }}</div>
                            <div class="track-artists">by {{ track.artists }}</div>
                        </li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Slide 3: Transition to Top Artists -->
            <div class="slide active">
                <h2 class="section-title">YOUR TOP ARTIST WAS {{top_artists.0.name}}</h2>
                <ul class="track-list">
                    <h3>BUT YOU HAD ROOM IN YOUR HEART FOR MORE THAN ONE...</h3>
                </ul>
            </div>

            <!-- Slide 4: Top Artists -->
            <div class="slide">
                <h2 class="section-title">Top Artists</h2>
                <ul class="artist-list">
                    {% for artist in top_artists %}
                        <li class="artist-item">{{ artist.name }}</li>
                    {% endfor %}
                </ul>
            </div>

            <!-- Slide 5: Transition to Top Genres -->
            <div class="slide active">
                <h2 class="section-title">This year was a feast for your ears</h2>
                <ul class="track-list">
                    <h3>Your top genre was {{top_genres.0}}</h3>
                </ul>
            </div>

            <!-- Slide 6: Top Genres -->
            <div class="slide">
                <h2 class="section-title">Top Genres</h2>
                <div class="genre-list-container" id="genre-list">
                    {% for genre in top_genres %}
                        <div class="genre-item">{{ genre }}</div>
                    {% endfor %}
                </div>
            </div>

           <!-- Slide 7: Lyrics Guessing Game Slide -->
            <div class="slide">
                {% if game_over %}
                    <div id="game-over"></div>
                    <h2>Game Over!</h2>
                    <p>Your final score is: {{ final_score }}</p>
                    <form method="POST">
                        {% csrf_token %}
                        <button type="submit" name="play_again" value="true">Play Again</button>
                    </form>
                {% else %}
                    <h2>Guess the Song!</h2>
                    <!-- Timer and Score Section -->
                    <div class="game-info">
                        <p>Time Left: <span id="timer">30</span> seconds</p>
                        <div id="timer-bar"></div>
                        <p>Score: <span id="score">{{ score }}</span></p>
                    </div>
                    <p><strong>Lyric Snippet:</strong> "{{ snippet }}"</p>
                    <p><em>Artist:</em> {{ artist_name }}</p>
                    <form method="POST" id="game-form">
                        {% csrf_token %}
                        <input type="text" name="guess" id="guess-input" placeholder="Enter song name" required>
                        <button type="submit">Submit</button>
                    </form>
                    {% if game_result %}
                        <p id="result">{{ game_result }}</p>
                    {% endif %}
                {% endif %}
            </div>

            <!-- Slide 8: llms -->
            <div class="slide">
                <h2 class="section-title">Your Personality Description</h2>
                <p class="llm-description">
                <p>{{ llm_description }}</p>
                    
                    <!-- {% if wrap.llm_description %}
                        {{ llm_description }}
                    {% else %}
                        No description available. Try generating a new wrap.
                    {% endif %} -->
                </p>
            </div>

        <!-- Slide 9: Share Your Wrapped -->
        <div class="slide">
          <h2 class="section-title">Share Your Wrapped</h2>
          <p>Share your music wrapped with your friends!</p>
          <div class="social-share-buttons">
            <!-- Facebook Share Button -->
            <a
              href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri|urlencode }}"
              target="_blank"
              class="social-button facebook-button"
              >Share on Facebook</a
            >

            <!-- WhatsApp Share Button -->
            <a
              href="https://api.whatsapp.com/send?text={{ request.build_absolute_uri|urlencode }}"
              target="_blank"
              class="social-button whatsapp-button"
              >Share on WhatsApp</a
            >

            <!-- Twitter Share Button -->
            <a
              href="https://twitter.com/intent/tweet?text={{ wrap_name|urlencode }}%20-%20Check%20out%20my%20music%20Wrapped!%20%23MyMusicWrapped&url={{ request.build_absolute_uri|urlencode }}"
              target="_blank"
              class="social-button twitter-button"
            >Share on X</a>
          </div>
        </div>

            <!-- Add more slides here as needed -->
        </div>

        <div class="nav-buttons">
            <button id="prev" class="nav-btn">Previous</button>
            <button id="next" class="nav-btn">Next</button>
        </div>
    </div>

    <!-- <script>
    document.addEventListener("DOMContentLoaded", function () {
        const themeToggleButton = document.getElementById('toggle-theme');
        const themeStylesheet = document.getElementById('theme-stylesheet');
        const lightThemeStylesheet = document.getElementById('light-theme-stylesheet');

        themeToggleButton.addEventListener('click', () => {
            const currentTheme = themeStylesheet.getAttribute('href');

            // Toggle between light and dark theme
            if (currentTheme === '{% static "css/wrap_detail.css" %}') {
                // Switch to light theme for slides and disable dark theme
                lightThemeStylesheet.removeAttribute('disabled');
                themeStylesheet.setAttribute('href', '{% static "css/light-theme-slides.css" %}');
                themeToggleButton.textContent = "Toggle Dark Mode"; // Update button text
            } else {
                // Switch back to dark theme for slides
                themeStylesheet.setAttribute('href', '{% static "css/wrap_detail.css" %}');
                lightThemeStylesheet.setAttribute('disabled', 'true');
                themeToggleButton.textContent = "Toggle Light Mode"; // Update button text
            }
        });
    });
    </script> -->

    <script src="{% static 'js/wrap_detail.js' %}"></script>
</body>
</html>